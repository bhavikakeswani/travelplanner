{% extends 'base.html' %}

{% block title %}Dashboard - TravelPlanner{% endblock %}

{% block body_class %}dashboard-page{% endblock %}

{% block content %}
  <section class="dashboard-container">
    <div class="dashboard-card">
      <header class="dashboard-header">
        <h2>Welcome back, {{ current_user.username }} üåç</h2>
        <a href="{{url_for('home')}}" class="logout-btn"><i class="bi bi-box-arrow-right"></i> Logout</a>
      </header>

      <div class="dashboard-stats">
        <div class="stat-card">
          <h3>{{ user_trips | length }}</h3>
          <p>Total Trips</p>
        </div>

        <div class="stat-card">
          <h3>{{ upcoming | length }}</h3>
          <p>Upcoming Trips</p>
        </div>

        <div class="stat-card">
          <h3>{{ current_user.joined_on.strftime('%b %Y') }}</h3>
          <p>Member Since</p>
        </div>
      </div>

      <div class="trip-summary">

        {% if ongoing %}
        <h3>Your Ongoing Trip</h3>
        <div class="trip-cards">
          {% for trip in ongoing %}
            <a href="{{ url_for('trip_details', id=trip.id) }}" class="trip-card-link">
              <div class="trip-card">
                <img src="{{ trip.image if trip.image else 'https://via.placeholder.com/600x400' }}" alt="Trip Image">
                <div class="trip-info">
                  <h4>{{ trip.destination }}</h4>
                  <p><i class="bi bi-calendar-event"></i> {{ trip.start_date }} ‚Äì {{ trip.end_date }}</p>
                  <p><i class="bi bi-geo-alt-fill"></i> {{ trip.destination }}</p>
                </div>
              </div>
            </a>
          {% endfor %}
        </div>
        {% endif %}

        {% if upcoming %}
        <h3 class="upcoming-trips-title">Your Upcoming Trips</h3>
        <div class="trip-cards">
          {% for trip in upcoming[:3] %}
            <a href="{{ url_for('trip_details', id=trip.id) }}" class="trip-card-link">
              <div class="trip-card">
                <img src="{{ trip.image if trip.image else 'https://via.placeholder.com/600x400' }}" alt="Trip Image">
                <div class="trip-info">
                  <h4>{{ trip.destination }}</h4>
                  <p><i class="bi bi-calendar-event"></i> {{ trip.start_date }} ‚Äì {{ trip.end_date }}</p>
                  <p><i class="bi bi-geo-alt-fill"></i> {{ trip.destination }}</p>
                </div>
              </div>
            </a>
          {% endfor %}
        </div>
        {% endif %}

        {% if not upcoming and not ongoing %}
          <div class="empty-state">
            <p>No trips yet</p>
            <p class="empty-subtext">Start planning your first adventure today.</p>
            <a href="{{ url_for('create_trip') }}" class="auth-btn">
              <i class="bi bi-plus-circle"></i> Create Your First Trip
            </a>
          </div>
        {% endif %}

        {% if past %}
          <h3 class="past-trips-title">Your Past Trips</h3>
          <div class="trip-cards">
            {% for trip in past%}
              <a href="{{ url_for('trip_details', id=trip.id) }}" class="trip-card-link">
                <div class="trip-card past-trip">
                  <img src="{{ trip.image if trip.image else 'https://via.placeholder.com/600x400' }}" alt="Trip Image">
                  <div class="trip-info">
                    <h4>
                      {{ trip.destination }}
                      <span class="badge past">Past</span>
                    </h4>
                    <p><i class="bi bi-calendar-event"></i> {{ trip.start_date }} ‚Äì {{ trip.end_date }}</p>
                    <p><i class="bi bi-geo-alt-fill"></i> {{ trip.destination }}</p>
                  </div>
                </div>
              </a>
            {% endfor %}
          </div>
          {% endif %}

      </div>

      <div class="dashboard-actions">
        <a href="{{url_for('explore')}}" class="auth-btn"><i class="bi bi-plus-circle"></i> Add New Trip</a>
      </div>

      <footer class="dashboard-footer">
        &copy; 2025 TravelPlanner. Plan your next adventure ‚úàÔ∏è
      </footer>
    </div>
  </section>
{% endblock %}